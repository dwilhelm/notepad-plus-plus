<?xml version="1.0" encoding="utf-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
    <Product
        Name="Notepad++ $(var.Version)"
        Manufacturer="David Wilhelm"
        Id="81B2BDDA-038E-4487-BE00-13B783163779" 
        UpgradeCode="32EA6821-1D35-476F-B0D6-2F6C40C33486"
        Language="1033"
        Codepage="1252"
        Version="$(var.Version)">

        <Package
            Id="*"
            Keywords="Installer"
            Description="Notepad++ $(var.Version) Installer"
            Comments="David Wilhelm fork of Notepad++"
            Manufacturer="David Wilhelm"
            InstallerVersion="200"
            Languages="1033"
            SummaryCodepage="1252"
            Compressed="yes"
            Platform="x64"
        />

        <Media Id="1" Cabinet="npp.cab" EmbedCab="yes" DiskPrompt="CD-ROM #1" />

        <Property Id="DiskPrompt" Value="Notepad++ Installation [1]" />

        <Directory Id="TARGETDIR" Name="SourceDir">

            <Directory Id="ProgramFiles64Folder" Name="PFiles">
                <Directory Id="INSTALLDIR" Name="Notepad++-$(var.Version)">
                    <Component Id="MainExecutable" Guid="86A1F97D-0F2D-4FF1-B204-309AD0C381A8" Win64="yes">
                        <File Id="nppEXE" Name="notepad++.exe" DiskId="1" Source="notepad++.exe"  KeyPath="yes" />
                    </Component>
                    <Component Id="SciLexerLibrary" Guid="C82D338C-79F8-4C63-BA75-BB1103675880" Win64="yes">
                        <File Id="SciLexerDLL" Name="SciLexer.dll" DiskId="1" Source="SciLexer.dll" KeyPath="yes" />
                    </Component>
                </Directory>
            </Directory>

            <Directory Id="ProgramMenuFolder" Name="Programs">
                <Directory Id="ProgramMenuDir" Name="Notepad++-$(var.Version)">
                    <Component Id="ProgramMenuDir" Guid="70ABA2B5-60D7-4C89-82F8-BAFE4DAF464F">
                        <RemoveFolder Id="ProgramMenuDir" On="uninstall" />
                        <RegistryValue Root="HKCU" Key="Software\[Manufacturer]\[ProductName]" Type="string" Value="" KeyPath="yes" />
                    </Component>
                </Directory>
            </Directory>

        </Directory>

        <Feature Id="Complete" Level="1">
            <ComponentRef Id="MainExecutable" />
            <ComponentRef Id="SciLexerLibrary" />
            <ComponentRef Id="ProgramMenuDir" />
        </Feature>

    </Product>
</Wix>
